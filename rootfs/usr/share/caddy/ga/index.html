<!doctype html>
<html lang="en" class="h-100">

<head>
  <title>data.coley.au</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="shortcut icon" type="image/png" href="/favicon-32x32.png" />
</head>

<body class="d-flex flex-column h-100">
  <header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="#"><img src="/favicon-32x32.png"> data.coley.au</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
          aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav me-auto mb-2 mb-md-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/ga/">GA</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/rpt/">RPT</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <main class="flex-shrink-0">
    <div class="container mt-5">
      <br />
      <h3>
        General Aviation
        <small class="text-muted">Flight Log</small>
      </h3>
      <div class="row">
        <div class="col-md-12">
          <table class="table table-hover table-sm">
            <thead>
              <tr>
                <th scope="col">&nbsp;</th>
                <th scope="col">Date</th>
                <th scope="col">Type</th>
                <th scope="col">Reg</th>
                <th scope="col">PIC</th>
                <th scope="col">Crew</th>
                <th scope="col">Route</th>
                <th scope="col">Details</th>
                <th scope="col">Dual</th>
                <th scope="col">Command</th>
                <th scope="col">Simulator</th>
                <th scope="col">Links</th>
              </tr>
            </thead>
            <tbody class="table-group-divider" id="table_body">
            </tbody>
          </table>
        </div>
      </div>
      <br />
      <br />
    </div>
  </main>
  <footer class="footer mt-auto py-3 bg-light">
    <div class="container">
      <span class="text-muted">data.coley.au Copyright 2023</span>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"
    integrity="sha384-rY/jv8mMhqDabXSo+UCggqKtdmBfd3qC2/KvyTDNQ6PcUJXaxK1tMepoQda4g5vB"
    crossorigin="anonymous"></script>
  <script>
    $(document).ready(function () {
      showSpinner();

      fetchData(0)
    });

    function showSpinner() {
      $("#table_body").html('<tr><td colspan="9" class="align-middle"><div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div></td></tr>');
    }

    function fetchData(next) {
      $.ajax({
        type: "GET",
        url: "https://data.coley.au/api/v1/galog/log.json?_labels=on&_size=10&_next=" + next,
        dataType: "json"
      }).success(function (result, status, xhr) {
        if (next === 0) {
          $("#table_body").html('');
        }
        var table_body = $("#table_body").html();
        result.rows.forEach(flight => {
          table_body += '<tr class="table">'
            table_body += '<td><i class="fa-solid fa-plane"></i></td>'
          for (var i = 0; i < 7; i++) {
            table_body += '<td>' + (flight[i] ?? '') + '</td>'
          }
          for (var i = 7; i < 10; i++) {
            table_body += '<td>' + (flight[i] ?? '0.0') + '</td>'
          }
          table_body += '<td>'
          if (flight[10]) {
            table_body += '<a href="' + flight[10] + '"><i class="fa-solid fa-blog"></i></a>'
          }
          if (flight[11]) {
            table_body += '<a href="' + flight[11] + '"><i class="fa-solid fa-image"></i></a>'
          }
          table_body += '</td>'
          table_body += '</tr>';
          $("#table_body").html(table_body);
        })
        if (result.next) {
          fetchData(result.next)
        }
      }).fail(function (xhr, status, error) {
        console.log("Result: " + status + " " + error + " " + xhr.status + " " + xhr.statusText)
      });
    };
  </script>
</body>

</html>